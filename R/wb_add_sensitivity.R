#' Add Companty Sensitivity Label
#'
#' @param wb A `wbWorkbook` object
#' @param sensitivity Sensitivity label, one of the following: "public", "internal" (default), "confidential", "secret"
#'
#' @return A `wbWorkbook` object
#' @export
#'
#' @examples wb %>% wb_add_sensitivity(sensitivity = "secret")
wb_add_sensitivity <- function(wb, sensitivity = c("internal", "public", "confidential", "secret")) {
  sensitivity <- sensitivity[1]
  custom_chr <- switch (sensitivity,
                        "public" = "<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"2\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_Enabled\"><vt:lpwstr>true</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"3\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_SetDate\"><vt:lpwstr>2024-03-27T13:46:58Z</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"4\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_Method\"><vt:lpwstr>Privileged</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"5\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_Name\"><vt:lpwstr>2ff753fd-faf2-4608-9b59-553f003adcdf</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"6\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_SiteId\"><vt:lpwstr>49618402-6ea3-441d-957d-7df8773fee54</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"7\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_ActionId\"><vt:lpwstr>c3a8cb11-ca75-4a70-94ed-d4c938b140c1</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"8\" name=\"MSIP_Label_2ff753fd-faf2-4608-9b59-553f003adcdf_ContentBits\"><vt:lpwstr>0</vt:lpwstr></property></Properties>",
                        "internal" = "<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"2\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_Enabled\"><vt:lpwstr>true</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"3\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_SetDate\"><vt:lpwstr>2024-03-26T15:00:03Z</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"4\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_Method\"><vt:lpwstr>Privileged</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"5\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_Name\"><vt:lpwstr>279dc149-7c28-4bdf-88ba-07214dba9bb1</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"6\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_SiteId\"><vt:lpwstr>49618402-6ea3-441d-957d-7df8773fee54</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"7\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_ActionId\"><vt:lpwstr>f303ab8d-97af-496b-a5d6-6822c7165241</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"8\" name=\"MSIP_Label_279dc149-7c28-4bdf-88ba-07214dba9bb1_ContentBits\"><vt:lpwstr>1</vt:lpwstr></property></Properties>",
                        "confidential" = "<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"2\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_Enabled\"><vt:lpwstr>true</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"3\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_SetDate\"><vt:lpwstr>2024-03-27T13:49:37Z</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"4\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_Method\"><vt:lpwstr>Privileged</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"5\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_Name\"><vt:lpwstr>1c79e38c-78b6-44a7-aaf7-caa852587f05</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"6\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_SiteId\"><vt:lpwstr>49618402-6ea3-441d-957d-7df8773fee54</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"7\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_ActionId\"><vt:lpwstr>eda32d21-c8dc-45fc-ad2a-27387289530e</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"8\" name=\"MSIP_Label_1c79e38c-78b6-44a7-aaf7-caa852587f05_ContentBits\"><vt:lpwstr>1</vt:lpwstr></property></Properties>",
                        "secret" = "<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"2\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_Enabled\"><vt:lpwstr>true</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"3\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_SetDate\"><vt:lpwstr>2024-03-27T13:50:01Z</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"4\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_Method\"><vt:lpwstr>Privileged</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"5\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_Name\"><vt:lpwstr>96deb7af-eb38-46a3-b993-cb71e7424d44</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"6\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_SiteId\"><vt:lpwstr>49618402-6ea3-441d-957d-7df8773fee54</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"7\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_ActionId\"><vt:lpwstr>7d182100-3977-40c9-bdd7-eaafa0fcbc12</vt:lpwstr></property><property fmtid=\"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}\" pid=\"8\" name=\"MSIP_Label_96deb7af-eb38-46a3-b993-cb71e7424d44_ContentBits\"><vt:lpwstr>1</vt:lpwstr></property></Properties>"
  )
  wb$custom <- custom_chr
  wb$append(
    "Content_Types",
    "<Override PartName=\"/docProps/custom.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.custom-properties+xml\"/>"
  )
  wb
}
